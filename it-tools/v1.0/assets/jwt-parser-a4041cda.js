import{m as c,d as x,p as T,b as D,q as J,c as I,w as b,x as M,o as i,h as O,g as S,y as j,f as d,e as l,r as v,F as m,t as _,N as f,z as F,B as V}from"./index-2e588a01.js";import{i as L}from"./boolean-f2550a48.js";import{w as G}from"./defaults-4d6daddf.js";import{_ as K}from"./Table-a39030ba.js";function h(t){this.message=t}h.prototype=new Error,h.prototype.name="InvalidCharacterError";var k=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new h("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,n,o=0,r=0,s="";n=e.charAt(r++);~n&&(a=o%4?64*a+n:n,o++%4)?s+=String.fromCharCode(255&a>>(-2*o&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return s};function U(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(a){return decodeURIComponent(k(a).replace(/(.)/g,function(n,o){var r=o.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}(e)}catch{return k(e)}}function u(t){this.message=t}function C(t,e){if(typeof t!="string")throw new u("Invalid token specified");var a=(e=e||{}).header===!0?0:1;try{return JSON.parse(U(t.split(".")[a]))}catch(n){throw new u("Invalid token specified: "+n.message)}}u.prototype=new Error,u.prototype.name="InvalidTokenError";const W={HS256:"SHA-256加密，HMAC签名",HS384:"SHA-384加密，HMAC签名",HS512:"SHA-512加密，HMAC签名",RS256:"SHA-256加密，RSASSA-PKCS1-v1_5签名",RS384:"SHA-384加密，RSASSA-PKCS1-v1_5签名",RS512:"SHA-512加密，RSASSA-PKCS1-v1_5签名",ES256:"P-256和SHA-256加密，ECDSA签名",ES384:"P-384和SHA-384加密，ECDSA签名",ES512:"P-521和SHA-512加密，ECDSA签名",PS256:"SHA-256和MGF1 SHA-256加密，RSASSA-PSS签名",PS384:"SHA-384和MGF1 SHA-384加密，RSASSA-PSS签名",PS512:"SHA-512和MGF1 SHA-512加密，RSASSA-PSS签名",none:"无加密和签名"},z={typ:"类型",alg:"算法",iss:"发行人",sub:"主题",aud:"观察者",exp:"到期时间",nbf:"之前没有",iat:"发行时间",jti:"JWT ID",name:"全名",given_name:"名",GivenName:"名",family_name:"姓",Surname:"姓",middle_name:"中间名",nickname:"昵称",preferred_username:"简称",profile:"个人资料URL",picture:"个人照片URL",website:"博客URL",email:"邮箱地址",Email:"邮箱地址",email_verified:"邮箱是否已验证",gender:"性别",birthdate:"生日",zoneinfo:"时区",locale:"区域",phone_number:"电话号码",phone_number_verified:"电话号码是否已验证",address:"居住地址",updated_at:"更新时间",azp:"颁发者",nonce:"关联值",auth_time:"认证时间",at_hash:"Access Token哈希值",c_hash:"Code哈希值",acr:"身份验证上下文类参考",amr:"身份验证方法参考",sub_jwk:"用于检查 ID Token 签名的公钥",cnf:"确认",sip_from_tag:"SIP From tag头域参数值",sip_date:"SIP Date 头字段值",sip_callid:"SIP Call-Id 头域值",sip_cseq_num:"SIP CSeq 数字头字段参数值",sip_via_branch:"SIP Via分支头域参数值",orig:"原始身份字符串",dest:"目标身份字符串",mky:"媒体密钥指纹字符串",events:"安全事件",toe:"事件时间",txn:"交易标识符",rph:"资源优先级标头授权",sid:"会话 ID",vot:"信任值向量",vtm:"信任信任标记 URL 向量",attest:"SHAKEN 框架中定义的证明级别",origid:"SHAKEN 框架中定义的原始标识符",act:"演员",scope:"范围值",client_id:"客户端标识符",may_act:"授权演员 - 被授权成为演员的一方",jcard:"j卡数据",at_use_nbr:"可以使用访问令牌的 API 请求数",div:"呼叫的转移目标",opt:"原始 PASSport（完整形式）",vc:"W3C 建议中指定的可验证凭证",vp:"W3C 建议中指定的可验证表示",sph:"SIP 优先级头字段",ace_profile:"应该与令牌一起使用的 ACE 配置文件。",cnonce:"客户端随机数",exi:"到期时间",roles:"规则",groups:"组",entitlements:"权利",token_introspection:"令牌内省响应"};function P({jwt:t}){const e=C(t,{header:!0}),a=C(t),n=c.map(e,(r,s)=>H({claim:s,value:r})),o=c.map(a,(r,s)=>H({claim:s,value:r}));return{header:n,payload:o}}function H({claim:t,value:e}){const a=z[t],n=c.isPlainObject(e)||c.isArray(e)?JSON.stringify(e,null,3):c.toString(e),o=B({claim:t,value:e});return{value:n,friendlyValue:o,claim:t,claimDescription:a}}function B({claim:t,value:e}){if(["exp","nbf","iat"].includes(t))return q(e);if(t==="alg"&&c.isString(e))return W[e]}function q(t){if(c.isNil(t))return;const e=new Date(Number(t)*1e3);return`${e.toLocaleDateString()} ${e.toLocaleTimeString()}`}const Q={colspan:"2",class:"table-header"},$={class:"claims"},X={"font-bold":""},Y={key:0,"ml-2":"","op-70":""},Z={key:0,"ml-2":"","op-70":""},ee=x({__name:"jwt-parser",setup(t){const e=T("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"),a=D(()=>G(()=>P({jwt:e.value}),{header:[],payload:[]})),n=[{key:"header",title:"Header 标头"},{key:"payload",title:"Payload 有效负载"}],o=J({source:e,rules:[{validator:r=>r.length>0&&L(()=>P({jwt:e.value})),message:"JWT 无效"}]});return(r,s)=>{const R=F,E=K,N=M;return i(),I(N,null,{default:b(()=>[O(R,{value:S(e),"onUpdate:value":s[0]||(s[0]=p=>j(e)?e.value=p:null),label:"JSON Web Token",validation:S(o),placeholder:"输入 token",rows:"5",multiline:"","raw-text":"",autofocus:"","mb-3":""},null,8,["value","validation"]),S(o).isValid?(i(),I(E,{key:0},{default:b(()=>[d("tbody",null,[(i(),l(m,null,v(n,p=>(i(),l(m,{key:p.key},[d("th",Q,_(p.title),1),(i(!0),l(m,null,v(S(a)[p.key],({claim:A,claimDescription:w,friendlyValue:g,value:y})=>(i(),l("tr",{key:A+y},[d("td",$,[d("span",X,_(A),1),w?(i(),l("span",Y," ("+_(w)+") ",1)):f("",!0)]),d("td",null,[d("span",null,_(y),1),g?(i(),l("span",Z," ("+_(g)+") ",1)):f("",!0)])]))),128))],64))),64))])]),_:1})):f("",!0)]),_:1})}}});const oe=V(ee,[["__scopeId","data-v-6c2b1887"]]);export{oe as default};
