import{m as h,d as x,p as y,b as m,e as l,h as d,g as p,y as k,w as g,f as i,z as b,x as U,k as L,o as _,t as f,F as w,r as F}from"./index-2e588a01.js";function I(t){const[o,e]=t.toString().split("e"),n=Number.parseFloat(o),s=n%1===0?n.toLocaleString():n.toFixed(2);return e?`${s}e${e}`:s}function C({seconds:t}){if(t<=.001)return"立即";if(t<=1)return"不到一秒";const o=[{unit:"century",secondsInUnit:31536e5,format:I,plural:"世纪"},{unit:"year",secondsInUnit:31536e3,plural:"年"},{unit:"month",secondsInUnit:2592e3,plural:"个月"},{unit:"week",secondsInUnit:604800,plural:"周"},{unit:"day",secondsInUnit:86400,plural:"天"},{unit:"hour",secondsInUnit:3600,plural:"小时"},{unit:"minute",secondsInUnit:60,plural:"分钟"},{unit:"second",secondsInUnit:1,plural:"秒"}];return h.chain(o).map(({unit:e,secondsInUnit:n,plural:s,format:a=h.identity})=>{const r=Math.floor(t/n);return t%=n,r<=0?void 0:`${a(r)} ${r>1?s:e}`}).compact().take(2).join(", ").value()}function N({password:t,guessesPerSecond:o=1e9}){const e=D({password:t}),n=t.length,s=t===""?0:Math.log2(e)*n,a=2**s/o,r=C({seconds:a}),c=Math.min(s/128,1);return{entropy:s,charsetLength:e,passwordLength:n,crackDurationFormatted:r,secondsToCrack:a,score:c}}function D({password:t}){const o=/[a-z]/.test(t),e=/[A-Z]/.test(t),n=/\d/.test(t),s=/\W|_/.test(t);let a=0;return o&&(a+=26),e&&(a+=26),n&&(a+=10),s&&(a+=32),a}const M={flex:"","flex-col":"","gap-3":""},$=i("div",{"op-60":""}," 暴力破解此密码所需的时间 ",-1),B={"text-2xl":"","data-test-id":"crack-duration"},E={"flex-1":"","text-right":"","op-60":""},S={"flex-1":"","text-left":""},T=i("div",{"op-70":""},[i("span",{"font-bold":""},"注意: "),L(" 计算的强度基于使用暴力方法破解密码所需的时间，它没有考虑字典攻击。 ")],-1),z=x({__name:"password-strength-analyser",setup(t){const o=y(""),e=m(()=>N({password:o.value})),n=m(()=>[{label:"密码长度:",value:e.value.passwordLength},{label:"熵（复杂程度）:",value:Math.round(e.value.entropy*100)/100},{label:"字符集大小:",value:e.value.charsetLength},{label:"评分:",value:`${Math.round(e.value.score*100)} / 100`}]);return(s,a)=>{const r=b,c=U;return _(),l("div",M,[d(r,{value:p(o),"onUpdate:value":a[0]||(a[0]=u=>k(o)?o.value=u:null),type:"password",placeholder:"输入密码",clearable:"",autofocus:"","raw-text":"","test-id":"password-input"},null,8,["value"]),d(c,{"text-center":""},{default:g(()=>[$,i("div",B,f(p(e).crackDurationFormatted),1)]),_:1}),d(c,null,{default:g(()=>[(_(!0),l(w,null,F(p(n),({label:u,value:v})=>(_(),l("div",{key:u,flex:"","gap-3":""},[i("div",E,f(u),1),i("div",S,f(v),1)]))),128))]),_:1}),T])}}});export{z as default};
