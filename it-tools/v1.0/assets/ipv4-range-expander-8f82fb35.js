import{d as w,o as p,e as v,a8 as L,J as D,b as g,f as u,t as F,g as s,h as c,m as M,C as V,q as S,y as x,c as k,w as m,N as T,z as U,F as j,r as q,k as J,a9 as G,n as H}from"./index-2e588a01.js";import{i as I,a as $}from"./ipv4-address-converter.service-8ffd7b54.js";import{c as N}from"./integer-base-converter.model-81b950ae.js";import{_ as C}from"./SpanCopyable.vue_vue_type_script_setup_true_lang-11dc0fa9.js";import{_ as K}from"./Alert-e0704bcc.js";import{_ as Q}from"./Table-a39030ba.js";const W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},X=L('<g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="5" cy="18" r="2"></circle><circle cx="19" cy="6" r="2"></circle><path d="M19 8v5a5 5 0 0 1-5 5h-3l3-3m0 6l-3-3"></path><path d="M5 16v-5a5 5 0 0 1 5-5h3l-3-3m0 6l3-3"></path></g>',1),Y=[X],Z=w({name:"Exchange",render:function(e,a){return p(),v("svg",W,Y)}});function y(t){return`${t>>>24}.${t>>16&255}.${t>>8&255}.${t&255}`}function f(t,e){return t==null||e==null?-1:1+Number.parseInt(e,2)-Number.parseInt(t,2)}function ee(t,e){if(t==null||e==null||f(t,e)<1)return null;let o=32;for(let i=0;i<32;i++)if(t[i]!==e[i]){o=i;break}const r=t.substring(0,o)+"0".repeat(32-o),n=e.substring(0,o)+"1".repeat(32-o);return{start:r,end:n,mask:o}}function te({startIp:t,endIp:e}){const a=N({value:I({ip:t}).toString(),fromBase:10,toBase:2}).padStart(32,"0"),o=N({value:I({ip:e}).toString(),fromBase:10,toBase:2}).padStart(32,"0"),r=ee(a,o);if(r!=null){const n={};return n.newEnd=y(Number.parseInt(r.end,2)),n.newStart=y(Number.parseInt(r.start,2)),n.newCidr=`${n.newStart}/${r.mask}`,n.newSize=f(r.start,r.end),n.oldSize=f(a,o),n}}const ae={"font-bold":""},ne=["data-test-id"],le=["data-test-id"],oe=w({__name:"result-row",props:{label:{default:""},oldValue:{default:""},newValue:{default:""}},setup(t){const e=t,{label:a,oldValue:o,newValue:r}=D(e),n=g(()=>M.kebabCase(a.value));return(i,h)=>(p(),v("tr",null,[u("td",ae,F(s(a)),1),u("td",{"data-test-id":`${s(n)}.old`},[c(C,{value:s(o),class:"monospace"},null,8,["value"])],8,ne),u("td",{"data-test-id":`${s(n)}.new`},[c(C,{value:s(r)},null,8,["value"])],8,le)]))}}),se={"mb-4":"",flex:"","gap-4":""},re=u("thead",null,[u("tr",null,[u("th",{scope:"col"},"   "),u("th",{scope:"col"}," 旧设置 "),u("th",{scope:"col"}," 新设置 ")])],-1),ue=u("div",{"my-3":"","op-70":""}," 结束 IPv4 地址 小于 起始 IPv4 地址。 这是无效的，无法计算结果。 在大多数情况下，解决此问题的方法是互换起始地址和结束地址。 ",-1),me=w({__name:"ipv4-range-expander",setup(t){const e=V("ipv4-range-expander:startAddress","192.168.1.1"),a=V("ipv4-range-expander:endAddress","192.168.6.255"),o=g(()=>te({startIp:e.value,endIp:a.value})),r=[{label:"起始地址",getOldValue:()=>e.value,getNewValue:l=>l?.newStart},{label:"结束地址",getOldValue:()=>a.value,getNewValue:l=>l?.newEnd},{label:"地址范围",getOldValue:l=>l?.oldSize?.toLocaleString(),getNewValue:l=>l?.newSize?.toLocaleString()},{label:"CIDR",getOldValue:()=>"",getNewValue:l=>l?.newCidr}],n=S({source:e,rules:[{message:"无效的 IPv4 地址",validator:l=>$({ip:l})}]}),i=S({source:a,rules:[{message:"无效的 IPv4 地址",validator:l=>$({ip:l})}]}),h=g(()=>i.isValid&&n.isValid&&o.value!==void 0);function B(){const l=e.value;e.value=a.value,a.value=l}return(l,_)=>{const b=U,E=Q,z=G,P=H,R=K;return p(),v("div",null,[u("div",se,[c(b,{value:s(e),"onUpdate:value":_[0]||(_[0]=d=>x(e)?e.value=d:null),label:"起始地址",placeholder:"IPv4 起始地址...",validation:s(n),clearable:""},null,8,["value","validation"]),c(b,{value:s(a),"onUpdate:value":_[1]||(_[1]=d=>x(a)?a.value=d:null),label:"结束地址",placeholder:"IPv4 结束地址...",validation:s(i),clearable:""},null,8,["value","validation"])]),s(h)?(p(),k(E,{key:0,"data-test-id":"result"},{default:m(()=>[re,u("tbody",null,[(p(),v(j,null,q(r,({label:d,getOldValue:A,getNewValue:O})=>c(oe,{key:d,label:d,"old-value":A(s(o)),"new-value":O(s(o))},null,8,["label","old-value","new-value"])),64))])]),_:1})):s(n).isValid&&s(i).isValid?(p(),k(R,{key:1,title:"起始和结束 IPv4 地址的组合无效",type:"error"},{default:m(()=>[ue,c(P,{onClick:B},{default:m(()=>[c(z,{"mr-2":"",component:s(Z),depth:"3",size:"22"},null,8,["component"]),J(" 互换起始地址和结束地址 ")]),_:1})]),_:1})):T("",!0)])}}});export{me as default};
